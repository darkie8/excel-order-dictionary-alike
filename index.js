"use strict";var __awaiter=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(a,s)}u((n=n.apply(e,r||[])).next())})},__generator=this&&this.__generator||function(e,r){var t,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=r.call(e,a)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},__read=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,i=t.call(e),a=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},__spread=this&&this.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(__read(arguments[r]));return e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.orderExcelSpecificWorkSheet=exports.orderExcel=exports.orderJSON=void 0;var XLSX=require("xlsx"),axios_1=require("axios"),fs=require("fs");function ordering(Z,key,col,type){try{var A1=type&&"bng"!==type?"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z":"অ আ ই ঈ উ ঊ ঋ এ ঐ ও ঔ ং ঃ ঁ ক খ গ ঘ ঙ চ ছ জ ঝ ঞ ট ঠ ড ঢ ণ ত ৎ থ দ ধ ন প ফ ব ভ ম য র ল শ ষ স হ ড় ঢ় য়",B1="া ি ী ু ূ ৃ ে ৈ ো ৌ",A2_1=A1.split(" "),B2_1=B1.split(" "),Z2=void 0,m="",n="",keyNames_1=Object.keys(Z.find(function(e){return Object.keys(e).length===col}));Z2=type&&"bng"!==type?Z.map(function(e){return e.pos=(e[key]?e[key].replace(" ",""):"ZZZZZ").toUpperCase().replace(/[.!@#$%^&*\[\]\(\)\/_+-=）（\→]/g,"").split("").map(function(e,r){return A2_1.indexOf(e)}),keyNames_1.forEach(function(r){e[r]=e[r]?e[r]:"N/A"}),e}):Z.map(function(e){return e.pos=(e[key]?e[key].replace(/ /g,""):"ঢ়য়").replace(/[.!@#$%^&*\[\]\(\)\/_+-=）（\→]/g,"").split("্").map(function(e,r){return e.split("").map(function(e,r,t){return B2_1.some(function(n){return n===e||n===t[r+1]})||A2_1.some(function(n,o){return(n==e||n===t[r+1])&&o<14})||r==t.length-1?e:e+"অ"}).join("")}).join("").split("").map(function(e,r,t){return-1===A2_1.indexOf(e)?B2_1.indexOf(e)+1:A2_1.indexOf(e)}).filter(function(e){return"NaN"!==e}),keyNames_1.forEach(function(r){e[r]=e[r]?e[r]:"N/A"}),e});var maxLength_1=Math.max.apply(Math,__spread(Z2.map(function(e){return e.pos.length})));Z2=Z2.map(function(e){for(var r=0;r<maxLength_1-e.pos.length;r++)e.pos.push(0);return e});for(var i=0;i<maxLength_1&&(n=(i===maxLength_1-1?"":":")+" a.pos["+i+"] - b.pos["+i+"]"+n,i!==maxLength_1-1);i++)m=m+"a.pos["+i+"] === b.pos["+i+"] ? ";return eval("let z = (a, b) =>"+m+n+";Z2.sort(z)"),Z2.map(function(e){return delete e.pos,e})}catch(e){throw e}}function orderexcel(e,r,t,n,o,i){return __awaiter(this,void 0,void 0,function(){var a,s,u,c,f,l,p;return __generator(this,function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),Buffer.isBuffer(e)?[3,2]:(c=(u=Buffer).from,[4,axios_1.default.get(e,{responseType:"arraybuffer"})]);case 1:return s=c.apply(u,[h.sent().data]),[3,3];case 2:s=e,h.label=3;case 3:return a=s,f=XLSX.read(a,{type:"buffer"}),l=f.SheetNames.reduce(function(e,r){var t=f.Sheets[r];return e[r]=XLSX.utils.sheet_to_json(t),e},{}),p=XLSX.utils.book_new(),Object.keys(l).forEach(function(e,o){var i=ordering(l[e],r[o],t[o],n);l[e]=i;var a=XLSX.utils.json_to_sheet(i);XLSX.utils.book_append_sheet(p,a,e)}),fs.writeFileSync(null!==o&&void 0!==o?o:"",XLSX.write(p,{bookType:"xlsx",type:"buffer"})),[2,i?l:void 0];case 4:throw h.sent();case 5:return[2]}})})}function orderexcelspecifiworksheet(e,r,t,n,o,i,a){return __awaiter(this,void 0,void 0,function(){var s,u,c,f,l,p,h,_,d;return __generator(this,function(y){switch(y.label){case 0:return y.trys.push([0,4,,5]),Buffer.isBuffer(e)?[3,2]:(f=(c=Buffer).from,[4,axios_1.default.get(e,{responseType:"arraybuffer"})]);case 1:return u=f.apply(c,[y.sent().data]),[3,3];case 2:u=e,y.label=3;case 3:if(s=u,l=XLSX.read(s,{type:"buffer"}),p=l.SheetNames.reduce(function(e,r){var t=l.Sheets[r];return e[r]=XLSX.utils.sheet_to_json(t),e},{}),h=XLSX.utils.book_new(),!p[r])throw new Error(r+" doesn't exist !");return _=ordering(p[r],t,n,o),p[r]=_,d=XLSX.utils.json_to_sheet(_),XLSX.utils.book_append_sheet(h,d,r),fs.writeFileSync(null!==i&&void 0!==i?i:"",XLSX.write(h,{bookType:"xlsx",type:"buffer"})),[2,a?p:void 0];case 4:throw y.sent();case 5:return[2]}})})}exports.orderJSON=ordering,exports.orderExcel=orderexcel,exports.orderExcelSpecificWorkSheet=orderexcelspecifiworksheet,exports.default=orderexcel;